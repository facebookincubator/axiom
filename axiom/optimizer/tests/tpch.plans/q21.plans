numWorkers: 1
numDrivers: 1

Query Graph:

dt1: s_name, numwait
  output:
    s_name := t2.s_name
    numwait := dt1.numwait
  tables: t2, t3, t4, t5, dt6, dt8
  joins:
    t3 SEMI dt6 ON t3.l_orderkey = dt6.l_orderkey_0 FILTER neq(dt6.l_suppkey_2, t3.l_suppkey)
    t3 SEMI dt8 ON t3.l_orderkey = dt8.l_orderkey_16 FILTER neq(dt8.l_suppkey_18, t3.l_suppkey)
    t2 INNER t3 ON t2.s_suppkey = t3.l_suppkey
    t3 INNER t4 ON t3.l_orderkey = t4.o_orderkey
    t2 INNER t5 ON t2.s_nationkey = t5.n_nationkey
  syntactic join order: 8, 28, 42, 49, 52, 91
  aggregates: count() AS numwait
  grouping keys: t2.s_name
  filter: dt1.__mark0 and not(dt1.__mark1)
  orderBy: dt1.numwait DESC NULLS LAST, t2.s_name ASC NULLS LAST
  limit: 100

t2: s_suppkey, s_name, s_nationkey
  table: supplier

t3: l_orderkey, l_suppkey, l_commitdate, l_receiptdate
  table: lineitem
  multi-column filters: lt(t3.l_commitdate, t3.l_receiptdate)

t4: o_orderkey, o_orderstatus
  table: orders
  single-column filters: eq(t4.o_orderstatus, "F")

t5: n_nationkey, n_name
  table: nation
  single-column filters: eq(t5.n_name, "SAUDI ARABIA")

dt6: l_orderkey_0, l_partkey_1, l_suppkey_2, l_linenumber_3, l_quantity_4, l_extendedprice_5, l_discount_6, l_tax_7, l_returnflag_8, l_linestatus_9, l_shipdate_10, l_commitdate_11, l_receiptdate_12, l_shipinstruct_13, l_shipmode_14, l_comment_15
  output:
    l_orderkey_0 := t7.l_orderkey
    l_partkey_1 := t7.l_partkey
    l_suppkey_2 := t7.l_suppkey
    l_linenumber_3 := t7.l_linenumber
    l_quantity_4 := t7.l_quantity
    l_extendedprice_5 := t7.l_extendedprice
    l_discount_6 := t7.l_discount
    l_tax_7 := t7.l_tax
    l_returnflag_8 := t7.l_returnflag
    l_linestatus_9 := t7.l_linestatus
    l_shipdate_10 := t7.l_shipdate
    l_commitdate_11 := t7.l_commitdate
    l_receiptdate_12 := t7.l_receiptdate
    l_shipinstruct_13 := t7.l_shipinstruct
    l_shipmode_14 := t7.l_shipmode
    l_comment_15 := t7.l_comment
  tables: t7

t7: l_orderkey, l_partkey, l_suppkey, l_linenumber, l_quantity, l_extendedprice, l_discount, l_tax, l_returnflag, l_linestatus, l_shipdate, l_commitdate, l_receiptdate, l_shipinstruct, l_shipmode, l_comment
  table: lineitem

dt8: l_orderkey_16, l_partkey_17, l_suppkey_18, l_linenumber_19, l_quantity_20, l_extendedprice_21, l_discount_22, l_tax_23, l_returnflag_24, l_linestatus_25, l_shipdate_26, l_commitdate_27, l_receiptdate_28, l_shipinstruct_29, l_shipmode_30, l_comment_31
  output:
    l_orderkey_16 := t9.l_orderkey
    l_partkey_17 := t9.l_partkey
    l_suppkey_18 := t9.l_suppkey
    l_linenumber_19 := t9.l_linenumber
    l_quantity_20 := t9.l_quantity
    l_extendedprice_21 := t9.l_extendedprice
    l_discount_22 := t9.l_discount
    l_tax_23 := t9.l_tax
    l_returnflag_24 := t9.l_returnflag
    l_linestatus_25 := t9.l_linestatus
    l_shipdate_26 := t9.l_shipdate
    l_commitdate_27 := t9.l_commitdate
    l_receiptdate_28 := t9.l_receiptdate
    l_shipinstruct_29 := t9.l_shipinstruct
    l_shipmode_30 := t9.l_shipmode
    l_comment_31 := t9.l_comment
  tables: t9

t9: l_orderkey, l_partkey, l_suppkey, l_linenumber, l_quantity, l_extendedprice, l_discount, l_tax, l_returnflag, l_linestatus, l_shipdate, l_commitdate, l_receiptdate, l_shipinstruct, l_shipmode, l_comment
  table: lineitem
  multi-column filters: lt(t9.l_commitdate, t9.l_receiptdate)


Optimized plan (oneline):

(lineitem RIGHT SEMI (PROJECT) (((lineitem INNER (supplier INNER nation)) INNER orders) LEFT SEMI (PROJECT) lineitem))

Optimized plan:

Project (redundant) -> dt1.s_name, dt1.numwait
    dt1.s_name := t2.s_name
    dt1.numwait := dt1.numwait
  OrderBy -> t2.s_name, dt1.numwait
    Aggregation (t2.s_name) -> t2.s_name, dt1.numwait
        dt1.numwait := count()
      Filter -> t2.s_name, dt1.__mark0
          dt1.__mark0
        Join RIGHT SEMI (PROJECT) Hash -> t2.s_name, dt1.__mark0
            dt6.l_orderkey_0 = t3.l_orderkey
            neq(dt6.l_suppkey_2, t3.l_suppkey)
          Project (redundant) -> dt6.l_orderkey_0, dt6.l_suppkey_2
              dt6.l_orderkey_0 := t7.l_orderkey
              dt6.l_suppkey_2 := t7.l_suppkey
            TableScan -> t7.l_orderkey, t7.l_suppkey
              table: lineitem
          HashBuild -> t2.s_name, t3.l_orderkey, t3.l_suppkey, dt1.__mark1
            Filter -> t2.s_name, t3.l_orderkey, t3.l_suppkey, dt1.__mark1
                not(dt1.__mark1)
              Join LEFT SEMI (PROJECT) Hash -> t2.s_name, t3.l_orderkey, t3.l_suppkey, dt1.__mark1
                  t3.l_orderkey = dt8.l_orderkey_16
                  neq(dt8.l_suppkey_18, t3.l_suppkey)
                Join INNER Hash -> t2.s_name, t3.l_orderkey, t3.l_suppkey
                    t3.l_orderkey = t4.o_orderkey
                  Join INNER Hash -> t2.s_name, t3.l_orderkey, t3.l_suppkey
                      t3.l_suppkey = t2.s_suppkey
                    TableScan -> t3.l_orderkey, t3.l_suppkey
                      table: lineitem
                      multi-column filters: lt(t3.l_commitdate, t3.l_receiptdate)
                    HashBuild -> t2.s_suppkey, t2.s_name, t2.s_nationkey, t5.n_nationkey
                      Join INNER Hash -> t2.s_suppkey, t2.s_name, t2.s_nationkey, t5.n_nationkey
                          t2.s_nationkey = t5.n_nationkey
                        TableScan -> t2.s_suppkey, t2.s_name, t2.s_nationkey
                          table: supplier
                        HashBuild -> t5.n_nationkey
                          TableScan -> t5.n_nationkey
                            table: nation
                            single-column filters: eq(t5.n_name, "SAUDI ARABIA")
                  HashBuild -> t4.o_orderkey
                    TableScan -> t4.o_orderkey
                      table: orders
                      single-column filters: eq(t4.o_orderstatus, "F")
                HashBuild -> dt8.l_orderkey_16, dt8.l_suppkey_18
                  Project (redundant) -> dt8.l_orderkey_16, dt8.l_suppkey_18
                      dt8.l_orderkey_16 := t9.l_orderkey
                      dt8.l_suppkey_18 := t9.l_suppkey
                    TableScan -> t9.l_orderkey, t9.l_suppkey
                      table: lineitem
                      multi-column filters: lt(t9.l_commitdate, t9.l_receiptdate)


Executable Velox plan:

Fragment 0:  numWorkers=0:
-- TopN[14][100 numwait DESC NULLS LAST, s_name ASC NULLS LAST] -> s_name:VARCHAR, numwait:BIGINT
  -- Aggregation[13][SINGLE [s_name] numwait := count()] -> s_name:VARCHAR, numwait:BIGINT
    -- Filter[0][expression: "dt1.__mark0"] -> s_name:VARCHAR, "dt1.__mark0":BOOLEAN
      -- HashJoin[12][RIGHT SEMI (PROJECT) l_orderkey_0=l_orderkey, filter: neq("l_suppkey_2","l_suppkey")] -> s_name:VARCHAR, "dt1.__mark0":BOOLEAN
        -- TableScan[1][table: lineitem, data columns: ROW<l_orderkey:BIGINT,l_partkey:BIGINT,l_suppkey:BIGINT,l_linenumber:INTEGER,l_quantity:DOUBLE,l_extendedprice:DOUBLE,l_discount:DOUBLE,l_tax:DOUBLE,l_returnflag:VARCHAR,l_linestatus:VARCHAR,l_shipdate:DATE,l_commitdate:DATE,l_receiptdate:DATE,l_shipinstruct:VARCHAR,l_shipmode:VARCHAR,l_comment:VARCHAR>] -> l_orderkey_0:BIGINT, l_suppkey_2:BIGINT
        -- Filter[2][expression: not("dt1.__mark1")] -> s_name:VARCHAR, l_orderkey:BIGINT, l_suppkey:BIGINT, "dt1.__mark1":BOOLEAN
          -- HashJoin[11][LEFT SEMI (PROJECT) l_orderkey=l_orderkey_16, filter: neq("l_suppkey_18","l_suppkey")] -> s_name:VARCHAR, l_orderkey:BIGINT, l_suppkey:BIGINT, "dt1.__mark1":BOOLEAN
            -- HashJoin[9][INNER l_orderkey=o_orderkey] -> s_name:VARCHAR, l_orderkey:BIGINT, l_suppkey:BIGINT
              -- HashJoin[7][INNER l_suppkey=s_suppkey] -> s_name:VARCHAR, l_orderkey:BIGINT, l_suppkey:BIGINT
                -- TableScan[3][table: lineitem, remaining filter: (lt("l_commitdate","l_receiptdate")), data columns: ROW<l_orderkey:BIGINT,l_partkey:BIGINT,l_suppkey:BIGINT,l_linenumber:INTEGER,l_quantity:DOUBLE,l_extendedprice:DOUBLE,l_discount:DOUBLE,l_tax:DOUBLE,l_returnflag:VARCHAR,l_linestatus:VARCHAR,l_shipdate:DATE,l_commitdate:DATE,l_receiptdate:DATE,l_shipinstruct:VARCHAR,l_shipmode:VARCHAR,l_comment:VARCHAR>] -> l_orderkey:BIGINT, l_suppkey:BIGINT
                -- HashJoin[6][INNER s_nationkey=n_nationkey] -> s_suppkey:BIGINT, s_name:VARCHAR, s_nationkey:BIGINT, n_nationkey:BIGINT
                  -- TableScan[4][table: supplier, data columns: ROW<s_suppkey:BIGINT,s_name:VARCHAR,s_address:VARCHAR,s_nationkey:BIGINT,s_phone:VARCHAR,s_acctbal:DOUBLE,s_comment:VARCHAR>] -> s_suppkey:BIGINT, s_name:VARCHAR, s_nationkey:BIGINT
                  -- TableScan[5][table: nation, range filters: [(n_name, Filter(BytesValues, deterministic, null not allowed))], data columns: ROW<n_nationkey:BIGINT,n_name:VARCHAR,n_regionkey:BIGINT,n_comment:VARCHAR>] -> n_nationkey:BIGINT
              -- TableScan[8][table: orders, range filters: [(o_orderstatus, Filter(BytesValues, deterministic, null not allowed))], data columns: ROW<o_orderkey:BIGINT,o_custkey:BIGINT,o_orderstatus:VARCHAR,o_totalprice:DOUBLE,o_orderdate:DATE,o_orderpriority:VARCHAR,o_clerk:VARCHAR,o_shippriority:INTEGER,o_comment:VARCHAR>] -> o_orderkey:BIGINT
            -- TableScan[10][table: lineitem, remaining filter: (lt("l_commitdate","l_receiptdate")), data columns: ROW<l_orderkey:BIGINT,l_partkey:BIGINT,l_suppkey:BIGINT,l_linenumber:INTEGER,l_quantity:DOUBLE,l_extendedprice:DOUBLE,l_discount:DOUBLE,l_tax:DOUBLE,l_returnflag:VARCHAR,l_linestatus:VARCHAR,l_shipdate:DATE,l_commitdate:DATE,l_receiptdate:DATE,l_shipinstruct:VARCHAR,l_shipmode:VARCHAR,l_comment:VARCHAR>] -> l_orderkey_16:BIGINT, l_suppkey_18:BIGINT

___END___
