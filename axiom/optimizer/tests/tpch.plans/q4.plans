numWorkers: 1
numDrivers: 1

Query Graph:

dt1: o_orderpriority, order_count
  output:
    o_orderpriority := t2.o_orderpriority
    order_count := dt1.order_count
  tables: t2, dt3
  joins:
    t2 SEMI dt3 ON t2.o_orderkey = dt3.l_orderkey
  syntactic join order: 10, 14
  aggregates: count() AS order_count
  grouping keys: t2.o_orderpriority
  filter: dt1.__mark0
  orderBy: t2.o_orderpriority ASC NULLS LAST

t2: o_orderkey, o_orderdate, o_orderpriority
  table: orders
  single-column filters: gte(t2.o_orderdate, "1993-07-01") and lt(__cast(t2.o_orderdate), "1993-10-01")

dt3: l_orderkey, l_partkey, l_suppkey, l_linenumber, l_quantity, l_extendedprice, l_discount, l_tax, l_returnflag, l_linestatus, l_shipdate, l_commitdate, l_receiptdate, l_shipinstruct, l_shipmode, l_comment
  output:
    l_orderkey := t4.l_orderkey
    l_partkey := t4.l_partkey
    l_suppkey := t4.l_suppkey
    l_linenumber := t4.l_linenumber
    l_quantity := t4.l_quantity
    l_extendedprice := t4.l_extendedprice
    l_discount := t4.l_discount
    l_tax := t4.l_tax
    l_returnflag := t4.l_returnflag
    l_linestatus := t4.l_linestatus
    l_shipdate := t4.l_shipdate
    l_commitdate := t4.l_commitdate
    l_receiptdate := t4.l_receiptdate
    l_shipinstruct := t4.l_shipinstruct
    l_shipmode := t4.l_shipmode
    l_comment := t4.l_comment
  tables: t4

t4: l_orderkey, l_partkey, l_suppkey, l_linenumber, l_quantity, l_extendedprice, l_discount, l_tax, l_returnflag, l_linestatus, l_shipdate, l_commitdate, l_receiptdate, l_shipinstruct, l_shipmode, l_comment
  table: lineitem
  multi-column filters: lt(t4.l_commitdate, t4.l_receiptdate)


Optimized plan (oneline):

(lineitem RIGHT SEMI (PROJECT) orders)

Optimized plan:

Project (redundant) -> dt1.o_orderpriority, dt1.order_count
    dt1.o_orderpriority := t2.o_orderpriority
    dt1.order_count := dt1.order_count
  OrderBy -> t2.o_orderpriority, dt1.order_count
    Aggregation (t2.o_orderpriority) -> t2.o_orderpriority, dt1.order_count
        dt1.order_count := count()
      Filter -> t2.o_orderpriority, dt1.__mark0
          dt1.__mark0
        Join RIGHT SEMI (PROJECT) Hash -> t2.o_orderpriority, dt1.__mark0
            dt3.l_orderkey = t2.o_orderkey
          Project (redundant) -> dt3.l_orderkey
              dt3.l_orderkey := t4.l_orderkey
            TableScan -> t4.l_orderkey
              table: lineitem
              multi-column filters: lt(t4.l_commitdate, t4.l_receiptdate)
          HashBuild -> t2.o_orderkey, t2.o_orderpriority
            TableScan -> t2.o_orderkey, t2.o_orderpriority
              table: orders
              single-column filters: gte(t2.o_orderdate, "1993-07-01") and lt(__cast(t2.o_orderdate), "1993-10-01")


Executable Velox plan:

Fragment 0:  numWorkers=0:
-- OrderBy[5][o_orderpriority ASC NULLS LAST] -> o_orderpriority:VARCHAR, order_count:BIGINT
  -- Aggregation[4][SINGLE [o_orderpriority] order_count := count()] -> o_orderpriority:VARCHAR, order_count:BIGINT
    -- Filter[0][expression: "dt1.__mark0"] -> o_orderpriority:VARCHAR, "dt1.__mark0":BOOLEAN
      -- HashJoin[3][RIGHT SEMI (PROJECT) l_orderkey=o_orderkey] -> o_orderpriority:VARCHAR, "dt1.__mark0":BOOLEAN
        -- TableScan[1][table: lineitem, remaining filter: (lt("l_commitdate","l_receiptdate")), data columns: ROW<l_orderkey:BIGINT,l_partkey:BIGINT,l_suppkey:BIGINT,l_linenumber:INTEGER,l_quantity:DOUBLE,l_extendedprice:DOUBLE,l_discount:DOUBLE,l_tax:DOUBLE,l_returnflag:VARCHAR,l_linestatus:VARCHAR,l_shipdate:DATE,l_commitdate:DATE,l_receiptdate:DATE,l_shipinstruct:VARCHAR,l_shipmode:VARCHAR,l_comment:VARCHAR>] -> l_orderkey:BIGINT
        -- TableScan[2][table: orders, range filters: [(o_orderdate, BigintRange: [8582, 9223372036854775807] no nulls)], remaining filter: (lt(cast("o_orderdate" as DATE),1993-10-01)), data columns: ROW<o_orderkey:BIGINT,o_custkey:BIGINT,o_orderstatus:VARCHAR,o_totalprice:DOUBLE,o_orderdate:DATE,o_orderpriority:VARCHAR,o_clerk:VARCHAR,o_shippriority:INTEGER,o_comment:VARCHAR>] -> o_orderkey:BIGINT, o_orderpriority:VARCHAR

___END___
